{% extends "base/base.html" %}
{% block body %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Log</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* 全体のフォントサイズと行間を調整 */
        body {
            font-size: 1.1rem; /* 基本のフォントサイズを少し大きく */
            line-height: 1.6;  /* 行間を広くして読みやすく */
        }

        h1 {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            margin-bottom: 1rem;
        }

        /* テーブルのデザイン */
        .table {
            font-size: 1.2rem; /* テーブルのフォントサイズを少し大きく */
        }

        .table thead th {
            background-color: #8a8a8a;
            color: white;
            font-weight: bold;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: #f9f9f9;
        }
        .table-striped tbody tr:nth-of-type(even) {
            background-color: #e9f5f6;
        }

        /* 賞味期限や消費期限の文字に強調を加える */
        .expiration-date {
            font-weight: bold;
            color: #d9534f; /* 赤色に変更 */
            font-size: 1.3rem; /* フォントサイズを大きく */
        }

        /* ボタンのスタイル */
        .btn {
            font-size: 1rem;
        }

        /* テーブル内の文字の見やすさ */
        td {
            font-size: 1.1rem; /* テーブルの文字を少し大きく */
            vertical-align: middle;
        }

        /* 各列の幅を固定 */
        .ingredient-name {
            width: 25%; /* 食材名の幅 */
        }

        .expiration-date-column {
            width: 30%; /* 賞味期限, 消費期限の幅 */
        }

        .storage-method {
            width: 45%; /* 保存方法の幅 */
        }

        /* 賞味期限と消費期限を一行で表示 */
        .expiration-date span {
            display: block; /* 一行に収める */
        }

        .text-center {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="d-flex justify-content-end mb-3">
            <a href="?sort=delete" class="btn btn-outline-danger" id="sort-delete">期限外の食材を消去</a>
            <a href="?sort=all" class="btn btn-outline-primary me-2" id="sort-all">すべて表示</a>
            <a href="?sort=select" class="btn btn-outline-secondary" id="sort-select">期限内順</a>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th class="ingredient-name text-center">食材名</th>
                        <th class="expiration-date-column text-center">賞味期限, 消費期限</th>
                        <th class="storage-method text-center">保存方法</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in inventory_log %}
                        <tr>
                            <td class="ingredient-name text-center">{{ i.ingredient_name }}</td>
                            <td class="expiration-date-column text-center">
                                <span class="expiration-date">{{ i.expiration_date|date:"Y年m月d日" }}</span>
                            </td>
                            <td class="storage-method">{{ i.storage_method}}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script>
        // Sort table when clicked
        document.getElementById('sort-delete').addEventListener('click', () => sortTable(true));
        document.getElementById('sort-all').addEventListener('click', () => sortTable(true));
        document.getElementById('sort-select').addEventListener('click', () => sortTable(false));
    
        function sortTable(ascending) {
            const table = document.querySelector('.table tbody');
            const rows = Array.from(table.rows);
    
            rows.sort((a, b) => {
                const dateA = new Date(a.cells[1].textContent.trim());
                const dateB = new Date(b.cells[1].textContent.trim());
                return ascending ? dateA - dateB : dateB - dateA;
            });
    
            // Re-append sorted rows
            rows.forEach(row => table.appendChild(row));
        }
    </script>
</body>
{% endblock %}
