<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>材料とステップの入力</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
        <script>
            let stepCount = 1;  // ステップのカウントを初期化

            function addStep() {
                // 新しいステップを追加するためのHTMLを作成
                stepCount++;  // ステップのカウントを増加

                const stepFormContainer = document.getElementById("step-form-container");

                const newStepDiv = document.createElement("div");
                newStepDiv.classList.add("form-group");

                // ステップ番号の入力フィールド
                const stepNumberLabel = document.createElement("label");
                stepNumberLabel.setAttribute("for", "id_step_number_" + stepCount);
                stepNumberLabel.innerText = "ステップ番号";
                
                const stepNumberInput = document.createElement("input");
                stepNumberInput.type = "number";
                stepNumberInput.name = "step_number";
                stepNumberInput.classList.add("form-control");

                // 作り方の入力フィールド
                const stepTextLabel = document.createElement("label");
                stepTextLabel.setAttribute("for", "id_step_text_" + stepCount);
                stepTextLabel.innerText = "作り方 " + stepCount;

                const stepTextInput = document.createElement("input");
                stepTextInput.type = "text";
                stepTextInput.name = "step_text";
                stepTextInput.classList.add("form-control");

                // フォームに追加
                newStepDiv.appendChild(stepNumberLabel);
                newStepDiv.appendChild(stepNumberInput);
                newStepDiv.appendChild(stepTextLabel);
                newStepDiv.appendChild(stepTextInput);

                stepFormContainer.appendChild(newStepDiv);
            }
        </script>
    </head>
    <body>
        <div class="container mt-5">
            <h2>材料とステップを入力してください</h2>
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                
                <!-- 材料フォーム -->
                <div class="form-group">
                    <label for="id_material">材料名</label>
                    {{ ingredient_form.material }}
                </div>

                <div class="form-group">
                    <label for="id_amount">分量</label>
                    {{ ingredient_form.amount }}
                </div>

                <!-- ステップフォーム -->
                <div id="step-form-container">
                    <div class="form-group">
                        <label for="id_step_number">ステップ番号</label>
                        {{ step_form.step_number }}
                    </div>

                    <div class="form-group">
                        <label for="id_step_text">作り方 1</label>
                        {{ step_form.step_text }}
                    </div>
                </div>

                <div class="form-group">
                    <label for="id_step_image">作り方の写真</label>
                    {{ step_form.step_image }}
                </div>

                <div class="form-group">
                    <label for="id_step_video">作り方の動画</label>
                    {{ step_form.step_video }}
                </div>
                
                <button type="button" class="btn btn-secondary" onclick="addStep()">+ ステップを追加</button>

                <button type="submit" class="btn btn-primary">保存</button>
            </form>
        </div>
    </body>
</html>